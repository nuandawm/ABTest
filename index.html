<!DOCTYPE html>
<html>
<head>
<meta charset="ISO-8859-1">
<title>Insert title here</title>

<style type="text/css">
	.cb { clear: both; }
	.exp-cell { float: left; padding: 5px; }
	.bar { fill: steelblue; }
	#container { width: 200px; height: 200px; }
</style>

<script src="bower_components/jquery/dist/jquery.min.js"></script>
<script src="bower_components/underscore/underscore-min.js"></script>
<script src="bower_components/d3/d3.min.js"></script>
<script src="bower_components/progressbar.js/dist/progressbar.min.js"></script>

<script src="js/models/Sprint.js"></script>
<script src="js/views.js"></script>
<script src="js/core.js"></script>

<script type="text/javascript">
// TODO I'm supposing that every exp is seen from every user: I should add a "visibility" parameter to each exp
var expPercs = [
		// Good
		{A:0.5,B:0.3},
		{A:0.6,B:0.9},
		{A:0.7,B:0.9},
		// Bad
		{A:0.7,B:0.6},
		{A:0.9,B:0.6},
		{A:0.8,B:0.6},
		// Same
		{A:0.5,B:0.5},
		{A:0.5,B:0.5}
	];

$(function(){
	var params = {
			users: 1000
			// TODO
			// number of experiments
			// typology of experiments (good, bad, same)
			// quality of A version (low value==fix, high value==improvement)
		};
	//var expResults = simulate(params, expPercs);
	//resultsView(expResults);
	//var $container = $('#container');

	var circle = new ProgressBar.Circle('#container', {
		color: '#FCB03C',
		strokeWidth: 3,
		trailWidth: 1,
		duration: 1500,
		step: function(state, bar) {
			bar.setText('Puppa');
		}
	});

	var observedExpDataPromise = doIterations(params, expPercs, 5);

	console.log(observedExpDataPromise);

	circle.animate(1, function() {
		circle.animate(0);
	});

	/*var statisticsData = statisticAnalysis(expData, 10);
	console.log(statisticsData.frequencies);*/

	/*var width = 600, height = 400;

	var svg = d3.select('body').append('svg')
			.attr('width', width)
			.attr('height', height);
	var xDomain = [];
	for (var i in statisticsData.frequencies)
		xDomain.push(statisticsData.frequencies[i].x);
	var x = d3.scale.ordinal()
			.domain(xDomain)
			.rangeRoundBands([0, width], .3);
	var y = d3.scale.linear()
			.domain([0, statisticsData.maxFrequency])
			.range([height, 0]);

	svg.selectAll('.bar')
			.data(statisticsData.frequencies)
		.enter().append('rect')
			.attr('class','bar')
			.attr("x", function(d) { return x(d.x); })
			.attr("width", x.rangeBand())
			.attr("y", function(d){ return y(d.y) })
			.attr("height", function(d) { return height - y(d.y); });*/
	
	// TODO Calculate diff and liability (variance?) of AB test
})
</script>

</head>
<body>

<div id="container"></div>

</body>
</html>